% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eigencorr.R
\name{eigencorr}
\alias{eigencorr}
\title{eigencorr}
\usage{
eigencorr(object, num_pcs = 10, meta_cols = NULL)
}
\arguments{
\item{object}{A \code{geneda} object containing \code{normalized} and \code{metadata}, and
optionally \code{DimReduction} loadings.}

\item{num_pcs}{Number of principal components to correlate.}

\item{meta_cols}{Optional character vector of metadata column names to include.
Defaults to all metadata columns.}
}
\value{
A list with elements: cor_matrix, pval_matrix, stars, plot (ggplot)
}
\description{
Calculate Eigen-correlations from a \code{geneda} object and plot a
publication-quality heatmap using ggplot2 with numeric labels and
significance stars. For continuous variables, Pearson correlation is used.
P values follow this convention: p < 0.001, p < 0.01, p < 0.05 = three, two,
one stars, respectively.

Requires PCA loadings in \code{DimReduction(object)}; does not recompute PCA.
}
\examples{
\donttest{
mock_norm <- matrix(rnorm(5000 * 6, mean = 0, sd = 2), nrow = 5000, ncol = 6)
colnames(mock_norm) <- paste0("Sample", 1:6)
rownames(mock_norm) <- paste0("Gene", 1:5000)

# Sample metadata
mock_meta <- data.frame(condition = c("A","B","A","B","A","B"),
row.names = colnames(mock_norm))

# Construct GenEDA object
obj <- GenEDA(normalized = mock_norm, metadata = mock_meta)

# Run PCA
obj <- RunPCA(obj)

# Compute eigencorrelation plot using first 5 PCs
ec <- eigencorr(obj, num_pcs = 5)
ec$plot
}
}
